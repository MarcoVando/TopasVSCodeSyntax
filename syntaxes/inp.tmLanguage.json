{
  "name": "TOPAScode",
  "scopeName": "source.inp",
  "patterns": [
    { "include": "#keywords" },
    {"include": "#macro"},
    { "include": "#variable"},
    {"include": "#numbers"},
    { "include": "#operator"},
    { "include": "#cntrl_statement"},
    { "include": "#comments"},
    { "include": "#strings"},
    { "include": "#equation"}
    
  ],
  "repository": {
    "keywords": {
      "patterns": [
        {
          "name": "keyword.letter.inp",
          "match": "aberration_range_change_allowed\\b|accumulate_phases_and_save_to_file\\b|accumulate_phases_when\\b|activate\\b|add_pop_1st_2nd_peak\\b|add_to_cloud_N\\b|add_to_cloud_when\\b|add_to_phases_of_weak_reflections\\b|adps\\b|ai_anti_bump\\b|ai_closest_N\\b|ai_exclude_eq_0\\b|ai_flatten_with_tollerance_of\\b|ai_no_self_interation\\b|ai_only_eq_0\\b|ai_radius\\b|ai_sites_1\\b|ai_sites_2\\b|al\\b|amorphous_area\\b|amorphous_phase\\b|append_bond_lengths\\b|append_cartesian\\b|append_fractional\\b|apply_exp_scale\\b|approximate_A\\b|atomic_interaction\\b|atom_out\\b|auto_scale\\b|auto_sparse_CG\\b|axial_conv\\b|axial_del\\b|axial_n_beta\\b|a_add\\b|A_matrix\\b|A_matrix_normalized\\b|A_matrix_prm_filter\\b|b\\b|be\\b|beq\\b|bkg\\b|bootstrap_errors\\b|box_interaction\\b|break_cycle_if_true\\b|brindley_spherical_r_cm\\b|bring_2nd_peak_to_top\\b|broaden_peaks\\b|b_add\\b|c\\b|calculate_Lam\\b|capillary_diameter_mm\\b|capillary_divergent_beam\\b|capillary_parallel_beam\\b|capillary_u_cm_inv\\b|cell_mass\\b|cell_volume\\b|cf_hkl_file\\b|cf_in_A_matrix\\b|charge_flipping\\b|chi2\\b|chi2_convergence_criteria\\b|chk_for_best\\b|choose_from\\b|choose_randomly\\b|choose_to\\b|circles_conv\\b|cloud\\b|cloud\\b|cloud_atomic_separation\\b|cloud_atomic_separation\\b|cloud_extract_and_save_xyzs\\b|cloud_fit\\b|cloud_formation_omit_rwps\\b|cloud_gauss_fwhm\\b|cloud_gauss_fwhm\\b|cloud_I\\b|cloud_load\\b|cloud_load_fixed_starting\\b|cloud_load_xyzs\\b|cloud_load_xyzs\\b|cloud_load_xyzs_omit_rwps\\b|cloud_match_gauss_fwhm\\b|cloud_min_intensity\\b|cloud_number_to_extract\\b|cloud_N_to_extract\\b|cloud_population\\b|cloud_population\\b|cloud_pre_randimize_add_to\\b|cloud_save\\b|cloud_save\\b|cloud_save_match_xy\\b|cloud_save_processed_xyzs\\b|cloud_save_xyzs\\b|cloud_save_xyzs\\b|cloud_stay_within\\b|cloud_try_accept\\b|conserve_memory\\b|consider_lattice_parameters\\b|continue_after_convergence\\b|convolute_X_recal\\b|convolution_step\\b|corrected_weight_percent\\b|correct_for_atomic_scattering_factors\\b|correct_for_temperature_effects\\b|crystalline_area\\b|current_peak_max_x\\b|current_peak_min_x\\b|C_matrix\\b|C_matrix_normalized\\b|d\\b|def\\b|default_I_attributes\\b|degree_of_crystallinity\\b|del\\b|delete_observed_reflections\\b|del_approx\\b|determine_values_from_samples\\b|displace\\b|dont_merge_equivalent_reflections\\b|dont_merge_Friedel_pairs\\b|do_errors\\b|do_errors_include_penalties\\b|do_errors_include_restraints\\b|dummy\\b|dummy_str\\b|d_Is\\b|elemental_composition\\b|element_weight_percent\\b|element_weight_percent_known\\b|exclude\\b|existing_prm\\b|exp_conv_const\\b|exp_limit\\b|extend_calculated_sphere_to\\b|extra_X\\b|extra_X_left\\b|extra_X_right\\b|f0\\b|f0_f1_f11_atom\\b|f11\\b|f1\\b|filament_length\\b|file_out\\b|find_origin\\b|finish_X\\b|fit_obj\\b|fit_obj_phase\\b|Flack\\b|flat_crystal_pre_monochromator_axial_const\\b|flip_equation\\b|flip_neutron\\b|flip_regime_2\\b|flip_regime_3\\b|fn\\b|fourier_map\\b|fourier_map_formula\\b|fo_transform_X\\b|fraction_density_to_flip\\b|fraction_of_yobs_to_resample\\b|fraction_reflections_weak\\b|ft_conv\\b|ft_convolution\\b|ft_L_max\\b|ft_min\\b|ft_x_axis_range\\b|fullprof_format\\b|f_atom_quantity\\b|f_atom_type\\b|ga\\b|gauss_fwhm\\b|generate_name_append\\b|generate_stack_sequences\\b|generate_these\\b|gof\\b|grs_interaction\\b|gsas_format\\b|gui_add_bkg\\b|h1\\b|h2\\b|half_hat\\b|hat\\b|hat_height\\b|height\\b|histogram_match_scale_fwhm\\b|hklis\\b|hkl_Is\\b|hkl_m_d_th2\\b|hkl_Re_Im\\b|hm_covalent_fwhm\\b|hm_size_limit_in_fwhm\\b|I\\b|ignore_differences_in_Friedel_pairs\\b|index_d\\b|index_exclude_max_on_min_lp_less_than\\b|index_I\\b|index_lam\\b|index_max_lp\\b|index_max_Nc_on_No\\b|index_max_number_of_solutions\\b|index_max_th2_error\\b|index_max_zero_error\\b|index_min_lp\\b|index_th2\\b|index_th2_resolution\\b|index_x0\\b|index_zero_error\\b|insert\\b|inter\\b|in_cartesian\\b|in_FC\\b|in_str_format\\b|iters\\b|i_on_error_ratio_tolerance\\b|I_parameter_names_have_hkl\\b|la\\b|Lam\\b|lam\\b|layer\\b|layers_tol\\b|lebail\\b|lg\\b|lh\\b|line_min\\b|lo\\b|load\\b|local\\b|lor_fwhm\\b|lpsd_beam_spill_correct_intensity\\b|lpsd_equitorial_divergence_degrees\\b|lpsd_equitorial_sample_length_mm\\b|lpsd_th2_angular_range_degrees\\b|lp_search\\b|m1\\b|m2\\b|mag_atom_out\\b|mag_only\\b|mag_only_for_mag_sites\\b|mag_space_group\\b|marquardt_constant\\b|match_transition_matrix_stats\\b|max\\b|max_r\\b|max_X\\b|mg\\b|min\\b|min_d\\b|min_grid_spacing\\b|min_r\\b|min_X\\b|mixture_density_g_on_cm3\\b|mixture_MAC\\b|mlx\\b|mly\\b|mlz\\b|modify_initial_phases\\b|modify_peak\\b|modify_peak_apply_before_convolutions\\b|modify_peak_eqn\\b|more_accurate_Voigt\\b|move_to\\b|move_to_the_next_temperature_regardless_of_the_change_in_rwp\\b|n1\\b|n2\\b|n3\\b|n\\b|ndx_allp\\b|ndx_alp\\b|ndx_belp\\b|ndx_blp\\b|ndx_clp\\b|ndx_galp\\b|ndx_gof\\b|ndx_sg\\b|ndx_uni\\b|ndx_vol\\b|ndx_ze\\b|neutron_data\\b|normalize_FCs\\b|normals_plot\\b|normals_plot_min_d\\b|no_f11\\b|no_inline\\b|no_LIMIT_warnings\\b|no_normal_equations\\b|no_th_dependence\\b|number_of_sequences\\b|number_of_stacks_per_sequence\\b|numerical_area\\b|numerical_lor_gauss_conv\\b|numerical_lor_ymin_on_ymax\\b|num_hats\\b|num_highest_I_values_to_keep\\b|num_patterns_at_a_time\\b|num_posns\\b|num_runs\\b|num_unique_vx_vy\\b|n_avg\\b|occ\\b|occ_merge\\b|occ_merge_radius\\b|omit\\b|omit_hkls\\b|one_on_x_conv\\b|only_lps\\b|only_penalties\\b|on_best_goto\\b|on_best_rewind\\b|operate_on_points\\b|out\\b|out_A_matrix\\b|out_chi2\\b|out_dependences\\b|out_dependents_for\\b|out_eqn\\b|out_file\\b|out_fmt\\b|out_fmt_err\\b|out_prm_vals_dependents_filter\\b|out_prm_vals_filter\\b|out_prm_vals_on_convergence\\b|out_prm_vals_per_iteration\\b|out_record\\b|out_refinement_stats\\b|out_rwp\\b|pdf_convolute\\b|pdf_data\\b|pdf_for_pairs\\b|pdf_gauss_fwhm\\b|pdf_info\\b|pdf_only_eq_0\\b|pdf_scale_simple\\b|pdf_ymin_on_ymax\\b|pdf_zero\\b|peak_buffer_based_on\\b|peak_buffer_based_on_tol\\b|peak_buffer_step\\b|peak_type\\b|penalties_weighting_K1\\b|penalty\\b|pen_weight\\b|percent_zeros_before_sparse_A\\b|phase_MAC\\b|phase_name\\b|phase_out\\b|phase_penalties\\b|pick_atoms\\b|pick_atoms_when\\b|pk_xo\\b|point_for_site\\b|primary_soller_angle\\b|prm\\b|prm_with_error\\b|process_times\\b|pr_str\\b|push_peak\\b|pv_fwhm\\b|pv_lor\\b|qa\\b|qb\\b|qc\\b|quick_refine\\b|quick_refine_remove\\b|qx\\b|qy\\b|qz\\b|randomize_initial_phases_by\\b|randomize_on_errors\\b|randomize_phases_on_new_cycle_by\\b|rand_xyz\\b|range\\b|rebin_min_merge\\b|rebin_tollerance_in_Y\\b|rebin_with_dx_of\\b|recal_weighting_on_iter\\b|receiving_slit_length\\b|redo_hkls\\b|remove_phase\\b|report_on\\b|report_on_str\\b|resample_from_current_ycalc\\b|restraint\\b|return\\b|rigid\\b|rotate\\b|Rp\\b|Rs\\b|r_bragg\\b|r_exp\\b|r_exp_dash\\b|r_p\\b|r_p_dash\\b|r_wp\\b|r_wp_dash\\b|r_wp_normal\\b|sample_length\\b|save_best_chi2\\b|save_sequences\\b|save_sequences_as_strs\\b|save_values_as_best_after_randomization\\b|scale\\b|scale_Aij\\b|scale_density_below_threshold\\b|scale_E\\b|scale_F000\\b|scale_F\\b|scale_phases\\b|scale_phase_X\\b|scale_pks\\b|scale_top_peak\\b|scale_weak_reflections\\b|secondary_soller_angle\\b|seed\\b|set_initial_phases_to\\b|sh_alpha\\b|sh_Cij_prm\\b|sh_order\\b|site\\b|sites_angle\\b|sites_avg_rand_xyz\\b|sites_distance\\b|sites_flatten\\b|sites_geometry\\b|sites_rand_on_avg\\b|sites_rand_on_avg_distance_to_randomize\\b|sites_rand_on_avg_min_distance\\b|site_to_restrain\\b|siv_s1_s2\\b|smooth\\b|space_group\\b|sparse_A\\b|spherical_harmonics_hkl\\b|spiked_phase_measured_weight_percent\\b|spv_h1\\b|spv_h2\\b|spv_l1\\b|spv_l2\\b|stack\\b|stacked_hats_conv\\b|start_values_from_site\\b|start_X\\b|stop_when\\b|str\\b|strs\\b|str_hkl_angle\\b|str_hkl_smallest_angle\\b|str_mass\\b|str_mass\\b|sx\\b|sy\\b|symmetry_obey_0_to_1\\b|system_after_save_OUT\\b|system_before_save_OUT\\b|sz\\b|ta\\b|tag\\b|tag_2\\b|tangent_max_triplets_per_h\\b|tangent_min_triplets_per_h\\b|tangent_num_h_keep\\b|tangent_num_h_read\\b|tangent_num_k_read\\b|tangent_scale_difference_by\\b|tangent_tiny\\b|tb\\b|tc\\b|temperature\\b|test_a\\b|test_al\\b|test_b\\b|test_be\\b|test_c\\b|test_ga\\b|th2_offset\\b|to\\b|transition\\b|translate\\b|try_space_groups\\b|two_theta_calibration\\b|tx\\b|ty\\b|tz\\b|u11\\b|u12\\b|u13\\b|u22\\b|u23\\b|u33\\b|ua\\b|ub\\b|uc\\b|update\\b|user_defined_convolution\\b|user_threshold\\b|user_y\\b|use_best_values\\b|use_CG\\b|use_extrapolation\\b|use_Fc\\b|use_layer\\b|use_LU\\b|use_LU_for_errors\\b|use_tube_dispersion_coefficients\\b|ux\\b|uy\\b|uz\\b|v1\\b|val_on_continue\\b|verbose\\b|view_cloud\\b|view_structure\\b|volume\\b|weighted_Durbin_Watson\\b|weighting\\b|weighting_normal\\b|weight_percent\\b|weight_percent_amorphous\\b|whole_hat\\b|WPPM_correct_Is\\b|WPPM_ft_conv\\b|WPPM_L_max\\b|WPPM_th2_range\\b|x\\b|xdd\\b|xdds\\b|xdd_out\\b|xdd_scr\\b|xdd_sum\\b|xo\\b|xo_Is\\b|xye_format\\b|x_angle_scaler\\b|x_axis_to_energy_in_eV\\b|x_calculation_step\\b|x_scaler\\b|y\\b|yc_eqn\\b|ymin_on_ymax\\b|yobs_eqn\\b|yobs_to_xo_posn_yobs\\b|z\\b|z_add\\b|z_matrix\\b"
        },
        {
          "name": "keyword.control.less.inp",
          "match": "A01\\b|A11\\b|A_star\\b|B01\\b|B11\\b|B_star\\b|Cycle\\b|Cycle_Iter\\b|C_star\\b|Delta_E\\b|D_spacing\\b|Fcalc\\b|Fobs\\b|Get_Prm_Error\\b|H\\b|Iobs_no_scale_pks\\b|Iobs_no_scale_pks_err\\b|Iter\\b|I_after_scale_pks\\b|I_no_scale_pks\\b|K\\b|L\\b|Lam\\b|Lpa\\b|Lpb\\b|Lpc\\b|M\\b|Mi\\b|Peak_Calculation_Step\\b|QR_Num_Times_Consecutively_Small\\b|QR_Removed\\b|R\\b|Ri\\b|Rp\\b|Rs\\b|SigmaYobs\\b|Sites_Geometry_Angle\\b|Sites_Geometry_Dihedral_Angle\\b|Sites_Geometry_Distance\\b|T\\b|Th\\b|WPPM_L\\b|WPPM_Ln_k\\b|X1\\b|X2\\b|X\\b|Xi\\b|Xo\\b|Ycalc\\b|Yobs\\b|Yobs_dx_at\\b"
        },
         {
          "name": "keyword.control.inp",
          "match": "Abs\\b|AB_Cyl_Corr\\b|AL_Cyl_Corr\\b|And\\b|ArcCos\\b|ArcSin\\b|ArcTan\\b|Break\\b|Break_Cycle\\b|Constant\\b|Cos\\b|Cosh\\b|Erfc_Approx\\b|Erf_Approx\\b|Error\\b|Exp\\b|For\\b|Gamma_Approx\\b|Gamma_Ln_Approx\\b|Gamma_P\\b|Gamma_Q\\b|Get\\b|Get_Element_Weight\\b|Get_From_String\\b|If\\b|Ln\\b|Ln_Normal_x_at_CD\\b|Max\\b|Min\\b|Mod\\b|Obj_There\\b|Or\\b|Prm_There\\b|PV_Lor_from_GL\\b|Rand\\b|Round\\b|Sign\\b|Sin\\b|Sinh\\b|Sqrt\\b|Sum\\b|Tan\\b|Tanh\\b|Voigt_FWHM_GL\\b|Voigt_Integral_Breadth_GL\\b"
        },
         {
          "name": "meta.preprocessor.inp",
          "match": "#define\\b|#delete_macros\\b|#else\\b|#elseif\\b|#endif\\b|#if\\b|Name\\b|Syntax\\b|Description\\b|#ifdef\\b|#ifndef\\b|#include\\b|#m_argu\\b|#m_code\\b|#m_code_refine\\b|#m_else\\b|#m_elseif\\b|#m_endif\\b|#m_eqn\\b|#m_first_word\\b|#m_if\\b|#m_ifarg\\b|#m_one_word\\b|#m_out\\b|#m_unique\\b|#m_unique_not_refine\\b|#out\\b|#prm\\b|#undef\\b"
        }
      ]
    },
    "macro": {
      "patterns": [
        {
          "name": "entity.name.function.inp",
          "match": "DAT\\b|RAW\\b|RAW\\b|XDD\\b|XY\\b|XYE\\b|SCR\\b|SHELX_HKL4\\b|TOF_XYE\\b|TOF_GSAS\\b|Cubic\\b|Trigonal\\b|Tetragonal\\b|Hexagonal\\b|Rhombohedral\\b|No_Th_Dependence\\b|CuKa1\\b|CuK1sharp\\b|CuKa2_analyt\\b|CuKa2\\b|CuKa4_Holzer\\b|CuKa5\\b|CuKa5_Berger\\b|CoKa3\\b|CoKa7_Holzer\\b|CrKa7_Holzer\\b|FeKa7_Holzer\\b|MnKa7_Holzer\\b|NiKa5_Holzer\\b|MoKa2\\b|CuKb4_Holzer\\b|CoKb6_Holzer\\b|CrKb5_Holzer\\b|FeKb4_Holzer\\b|MnKb5_Holzer\\b|NiKb4_Holzer\\b|Radius\\b|Specimen_Tilt\\b|Slit_Width\\b|or\\b|SW\\b|Divergence\\b|Variable_Divergence\\b|Variable_Divergence_Shape\\b|Variable_Divergence_Intensity\\b|Simple_Axial_Model\\b|Full_Axial_Model\\b|Finger_et_al\\b|Tube_Tails\\b|UVW\\b|PV_Peak_Type\\b|TCHZ_Peak_Type\\b|PVII_Peak_Type\\b|Apply_Brindley_Spherical_R_PD\\b|MVW\\b|Cylindrical_2Th_Correction\\b|Zero_Error\\b|or\\b|ZE\\b|Specimen_Displacement\\b|or\\b|SD\\b|Cylindrical_I_Correction\\b|Lorentz_Factor,\\b|LP_Factor\\b|LP_Factor_Synchrotron,\\b|LP_Factor_Synchrotron_Simple\\b|Preferred_Orientation\\b|or\\b|PO\\b|PO_Two_Directions\\b|PO_Spherical_Harmonics\\b|Surface_Roughness_Pitschke_et_al\\b|Surface_Roughness_Suortti\\b|Anti_Bump\\b|AI_Anti_Bump,\\b|AI_Anti_Bump\\b|Parabola_N\\b|Grs_Interaction\\b|Grs_No_Repulsion\\b|Grs_BornMayer\\b|Distance_Restrain\\b|Angle_Restrain\\b|Flatten\\b|Distance_Restrain_Keep_Within\\b|Distance_Restrain_Keep_Out\\b|Keep_Atom_Within_Box\\b|Create_2Th_Ip_file\\b|Create_d_Ip_file\\b|Create_hklm_d_Th2_Ip_file\\b|Out_Yobs_Ycalc_and_Difference\\b|Out_X_Yobs\\b|Out_X_Yobs\\b|Out_X_Ycalc\\b|Out_X_Difference\\b|Out_F2_Details\\b|Out_A01_A11_B01_B11\\b|Out_FCF\\b|Out_CIF_STR\\b|Set_Length\\b|Set_Lengths\\b|Set_Lengths\\b|Triangle\\b|Triangle\\b|Triangle\\b|Tetrahedra\\b|Octahedra\\b|Octahedra\\b|Hexagon_sitting_on_point_in_xy_plane\\b|Hexagon_sitting_on_side_in_xy_plane\\b|Point_for_site\\b|Translate\\b|Translate\\b|Translate_with_site_start_values\\b|Rotate_about_points\\b|Rotate_about_points\\b|Rotate_about_these_points\\b|Rotate_about_axies\\b|Rotate_about_axies\\b|Rotation_vector_from_points\\b|One_on_X\\b|Bkg_Diffuse\\b|PV\\b|PV\\b|PV_Left_Right\\b|PV_Left_Right\\b|Sample_Thickness\\b|Absorption\\b|or\\b|AB\\b|Absorption_With_Sample_Thickness_mm_Shape\\b|Absorption_With_Sample_Thickness_mm_Shape_Intensity\\b|CS_L\\b|or\\b|Crystallite_Size\\b|or\\b|CS\\b|CS_G\\b|Strain_L\\b|or\\b|Microstrain\\b|or\\b|MS\\b|Strain_G\\b|LVol_FWHM_CS_G_L\\b|TOF_LAM\\b|TOF_x_axis_calibration\\b|TOF_Exponential\\b|TOF_CS_L\\b|TOF_CS_G\\b|TOF_PV\\b|Auto_T\\b|Temperature_Regime\\b|STR\\b|Exclude\\b|Decompose\\b|ADPs_Keep_PD\\b|Mixture_LAC_1_on_cm\\b|Phase_Density_g_on_cm3\\b|Phase_LAC_1_on_cm\\b|Gauss,\\b|Lorentzian\\b"
        }
      ]
    },
    "variable": {
      "patterns": [
        {
          "name": "variable.name.inp",
          "match": "[a-zA-Z]+(?:\\w?)+"
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.inp",
          "match": "(\\d*\\.?\\d+`?)|((-|\\.)\\d*\\.?\\d+`?)"
        },
        {
          "name": "variable.numeric.parameter.inp",
          "match": "\\(\\s*[[a-zA-Z][_\\-]]+\\s*,?\\s*\\d+\\.\\d+\\s*\\)"
        },
        {
          "name": "variable.numeric.parameter.inp",
          "match": "prm\\s*[[a-zA-Z][_\\-]]+\\s*-?\\d+(?:\\.\\d+)?"
        },
        {
          "name": "variable.numeric.inp",
          "match": "@(?:\\s+)?,?(?:\\s)?+(?:-?\\d+(?:\\.\\d+)?`?(?:\\s+)?)+"
        },
        {
          "name": "fix.numeric.inp",
          "match": "(!\\w+\\s+\\d*\\.?\\d+`?)|(!\\w+\\s+(-|\\.)\\d*\\.?\\d+`?)"
        }
      ]
    },
    "operator": {
      "patterns": [
        {
          "name": "keyword.operator",
          "match": "\\b----\\b"
        }
      ]
    },
    "cntrl_statement": {
      "patterns": [
        {
          "name": "invalid.allert.inp",
          "match": "\\b_LIMIT_MIN_-?\\d+(\\.\\d+`?)?|_LIMIT_MAX_-?\\d+(\\.\\d+`?)?"
        },
        {
          "name": "invalid.illegal.inp",
          "match": "(@\\d*\\.?\\d+`?)|(@(-|\\.)\\d*\\.?\\d+`?)"
        },
        {
          "name": "invalid.illegal.inp",
          "match": "(!\\d*\\.?\\d+`?)|(!(-|\\.)\\d*\\.?\\d+`?)"
        }
      ]
    },
    "comments": {
      "patterns": [
        {
          "name": "comment.inline",
          "match": "'.*"
        },
        {
          "begin":"/\\*",
          "end":"\\*/",
          "name": "comment.block"
        }
      ]
    },
    "strings": {
      "name": "string.quoted.double",
      "begin": "\"",
      "end": "\"",
      "patterns": [
        {
          "name": "constant.character.escape.inp",
          "match": "\\\\."
        }
      ]
    },
    "equation":{
      "patterns": [
        {
          "name": "equation.name.inp",
          "match": "=.+?;"
        }
      ]
    }
  }
}
